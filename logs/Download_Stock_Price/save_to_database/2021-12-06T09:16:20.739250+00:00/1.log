[2021-12-06 09:16:25,455] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: Download_Stock_Price.save_to_database manual__2021-12-06T09:16:20.739250+00:00 [queued]>
[2021-12-06 09:16:25,469] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: Download_Stock_Price.save_to_database manual__2021-12-06T09:16:20.739250+00:00 [queued]>
[2021-12-06 09:16:25,470] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2021-12-06 09:16:25,470] {taskinstance.py:1242} INFO - Starting attempt 1 of 2
[2021-12-06 09:16:25,471] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2021-12-06 09:16:25,494] {taskinstance.py:1262} INFO - Executing <Task(PythonOperator): save_to_database> on 2021-12-06 09:16:20.739250+00:00
[2021-12-06 09:16:25,500] {standard_task_runner.py:52} INFO - Started process 3417 to run task
[2021-12-06 09:16:25,504] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'Download_Stock_Price', 'save_to_database', 'manual__2021-12-06T09:16:20.739250+00:00', '--job-id', '49', '--raw', '--subdir', 'DAGS_FOLDER/download_stick_price.py', '--cfg-path', '/tmp/tmprlha3165', '--error-file', '/tmp/tmpszuta890']
[2021-12-06 09:16:25,506] {standard_task_runner.py:77} INFO - Job 49: Subtask save_to_database
[2021-12-06 09:16:25,572] {logging_mixin.py:109} INFO - Running <TaskInstance: Download_Stock_Price.save_to_database manual__2021-12-06T09:16:20.739250+00:00 [running]> on host 48b97d3f8617
[2021-12-06 09:16:25,637] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=tlzmkm@gmail.com
AIRFLOW_CTX_DAG_OWNER=tl
AIRFLOW_CTX_DAG_ID=Download_Stock_Price
AIRFLOW_CTX_TASK_ID=save_to_database
AIRFLOW_CTX_EXECUTION_DATE=2021-12-06T09:16:20.739250+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2021-12-06T09:16:20.739250+00:00
[2021-12-06 09:16:25,638] {logging_mixin.py:109} INFO - ['__class__', '__contains__', '__delattr__', '__delitem__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'clear', 'copy', 'fromkeys', 'get', 'items', 'keys', 'pop', 'popitem', 'setdefault', 'update', 'values']
[2021-12-06 09:16:25,639] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7ff2eca67310>, 'dag': <DAG: Download_Stock_Price>, 'dag_run': <DagRun Download_Stock_Price @ 2021-12-06 09:16:20.739250+00:00: manual__2021-12-06T09:16:20.739250+00:00, externally triggered: True>, 'data_interval_end': DateTime(2021, 12, 6, 5, 5, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 5, 5, 5, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-06', 'ds_nodash': '20211206', 'execution_date': <Proxy at 0x7ff2d0de4280 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0d72950>>, 'inlets': [], 'logical_date': DateTime(2021, 12, 6, 9, 16, 20, 739250, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': <Proxy at 0x7ff2d0de4500 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0d728c0>>, 'next_ds_nodash': <Proxy at 0x7ff2d0de48c0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2f80>>, 'next_execution_date': <Proxy at 0x7ff2d0e30960 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2e60>>, 'outlets': [], 'params': {}, 'prev_data_interval_start_success': <Proxy at 0x7ff2d0dee780 with factory <function TaskInstance.get_template_context.<locals>.get_prev_data_interval_start_success at 0x7ff2d0dccb00>>, 'prev_data_interval_end_success': <Proxy at 0x7ff2d0dee140 with factory <function TaskInstance.get_template_context.<locals>.get_prev_data_interval_end_success at 0x7ff2d0dcc8c0>>, 'prev_ds': <Proxy at 0x7ff2d0dee3c0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2710>>, 'prev_ds_nodash': <Proxy at 0x7ff2d0deeb40 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2c20>>, 'prev_execution_date': <Proxy at 0x7ff2d0deedc0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2ef0>>, 'prev_execution_date_success': <Proxy at 0x7ff2d0deee60 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2170>>, 'prev_start_date_success': <Proxy at 0x7ff2d0deefa0 with factory <function TaskInstance.get_template_context.<locals>.get_prev_start_date_success at 0x7ff2d0d72290>>, 'run_id': 'manual__2021-12-06T09:16:20.739250+00:00', 'task': <Task(PythonOperator): save_to_database>, 'task_instance': <TaskInstance: Download_Stock_Price.save_to_database manual__2021-12-06T09:16:20.739250+00:00 [running]>, 'task_instance_key_str': 'Download_Stock_Price__save_to_database__20211206', 'test_mode': False, 'ti': <TaskInstance: Download_Stock_Price.save_to_database manual__2021-12-06T09:16:20.739250+00:00 [running]>, 'tomorrow_ds': <Proxy at 0x7ff2d0dee910 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2b90>>, 'tomorrow_ds_nodash': <Proxy at 0x7ff2d0dee5a0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2d40>>, 'ts': '2021-12-06T09:16:20.739250+00:00', 'ts_nodash': '20211206T091620', 'ts_nodash_with_tz': '20211206T091620.739250+0000', 'var': {'json': None, 'value': None}, 'conn': <***.models.taskinstance.TaskInstance.get_template_context.<locals>.ConnectionAccessor object at 0x7ff2d0d771d0>, 'yesterday_ds': <Proxy at 0x7ff2d0dee4b0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2dd0>>, 'yesterday_ds_nodash': <Proxy at 0x7ff2d0e59aa0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de2cb0>>, 'templates_dict': None}
[2021-12-06 09:16:25,652] {logging_mixin.py:109} INFO - received tickers: ['MSFT', 'GE']
[2021-12-06 09:16:25,665] {base.py:79} INFO - Using connection to: id: demodb. Host: postgres, Port: 5432, Schema: demodb, Login: ***, Password: ***, extra: {}
[2021-12-06 09:16:25,676] {logging_mixin.py:109} INFO - MSFT length=21   ['MSFT', '2021-11-05', '337.8918270883794', '338.17131453746435', '333.8092998498156', '335.4462890625']
[2021-12-06 09:16:25,690] {logging_mixin.py:109} INFO - GE length=21   ['GE', '2021-11-05', '106.93000030517578', '109.6500015258789', '106.8499984741211', '108.73999786376953']
[2021-12-06 09:16:25,700] {logging_mixin.py:109} INFO - 21 record inserted.
[2021-12-06 09:16:25,701] {python.py:152} INFO - Done. Returned value was: None
[2021-12-06 09:16:25,722] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=Download_Stock_Price, task_id=save_to_database, execution_date=20211206T091620, start_date=20211206T091625, end_date=20211206T091625
[2021-12-06 09:16:25,760] {local_task_job.py:154} INFO - Task exited with return code 0
[2021-12-06 09:16:25,793] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
