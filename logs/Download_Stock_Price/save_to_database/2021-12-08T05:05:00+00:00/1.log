[2021-12-09 05:05:06,421] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-08T05:05:00+00:00 [queued]>
[2021-12-09 05:05:06,432] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-08T05:05:00+00:00 [queued]>
[2021-12-09 05:05:06,433] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2021-12-09 05:05:06,433] {taskinstance.py:1242} INFO - Starting attempt 1 of 2
[2021-12-09 05:05:06,434] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2021-12-09 05:05:06,453] {taskinstance.py:1262} INFO - Executing <Task(PythonOperator): save_to_database> on 2021-12-08 05:05:00+00:00
[2021-12-09 05:05:06,458] {standard_task_runner.py:52} INFO - Started process 49941 to run task
[2021-12-09 05:05:06,462] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'Download_Stock_Price', 'save_to_database', 'scheduled__2021-12-08T05:05:00+00:00', '--job-id', '55', '--raw', '--subdir', 'DAGS_FOLDER/download_stick_price.py', '--cfg-path', '/tmp/tmpao4rcwtd', '--error-file', '/tmp/tmpupal3m7s']
[2021-12-09 05:05:06,464] {standard_task_runner.py:77} INFO - Job 55: Subtask save_to_database
[2021-12-09 05:05:06,514] {logging_mixin.py:109} INFO - Running <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-08T05:05:00+00:00 [running]> on host 48b97d3f8617
[2021-12-09 05:05:06,564] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=tlzmkm@gmail.com
AIRFLOW_CTX_DAG_OWNER=tl
AIRFLOW_CTX_DAG_ID=Download_Stock_Price
AIRFLOW_CTX_TASK_ID=save_to_database
AIRFLOW_CTX_EXECUTION_DATE=2021-12-08T05:05:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-08T05:05:00+00:00
[2021-12-09 05:05:06,566] {logging_mixin.py:109} INFO - ['__class__', '__contains__', '__delattr__', '__delitem__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'clear', 'copy', 'fromkeys', 'get', 'items', 'keys', 'pop', 'popitem', 'setdefault', 'update', 'values']
[2021-12-09 05:05:06,567] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7ff2eca67310>, 'dag': <DAG: Download_Stock_Price>, 'dag_run': <DagRun Download_Stock_Price @ 2021-12-08 05:05:00+00:00: scheduled__2021-12-08T05:05:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 9, 5, 5, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 8, 5, 5, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-08', 'ds_nodash': '20211208', 'execution_date': <Proxy at 0x7ff2d0dede10 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0d71950>>, 'inlets': [], 'logical_date': DateTime(2021, 12, 8, 5, 5, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': <Proxy at 0x7ff2d0deda50 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1ef0>>, 'next_ds_nodash': <Proxy at 0x7ff2d0ded6e0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de17a0>>, 'next_execution_date': <Proxy at 0x7ff2d0ded5f0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1cb0>>, 'outlets': [], 'params': {}, 'prev_data_interval_start_success': <Proxy at 0x7ff2d0e5c8c0 with factory <function TaskInstance.get_template_context.<locals>.get_prev_data_interval_start_success at 0x7ff2d0dcbb90>>, 'prev_data_interval_end_success': <Proxy at 0x7ff2d0e49c30 with factory <function TaskInstance.get_template_context.<locals>.get_prev_data_interval_end_success at 0x7ff2d0dcb950>>, 'prev_ds': <Proxy at 0x7ff2d0e27d70 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1f80>>, 'prev_ds_nodash': <Proxy at 0x7ff2d0e275a0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1290>>, 'prev_execution_date': <Proxy at 0x7ff2d0e27dc0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1200>>, 'prev_execution_date_success': <Proxy at 0x7ff2d0de31e0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1dd0>>, 'prev_start_date_success': <Proxy at 0x7ff2d0de3c30 with factory <function TaskInstance.get_template_context.<locals>.get_prev_start_date_success at 0x7ff2d0d71320>>, 'run_id': 'scheduled__2021-12-08T05:05:00+00:00', 'task': <Task(PythonOperator): save_to_database>, 'task_instance': <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-08T05:05:00+00:00 [running]>, 'task_instance_key_str': 'Download_Stock_Price__save_to_database__20211208', 'test_mode': False, 'ti': <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-08T05:05:00+00:00 [running]>, 'tomorrow_ds': <Proxy at 0x7ff2d0de32d0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1710>>, 'tomorrow_ds_nodash': <Proxy at 0x7ff2d0de3af0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1e60>>, 'ts': '2021-12-08T05:05:00+00:00', 'ts_nodash': '20211208T050500', 'ts_nodash_with_tz': '20211208T050500+0000', 'var': {'json': None, 'value': None}, 'conn': <***.models.taskinstance.TaskInstance.get_template_context.<locals>.ConnectionAccessor object at 0x7ff2d0d76310>, 'yesterday_ds': <Proxy at 0x7ff2d0de3d70 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1d40>>, 'yesterday_ds_nodash': <Proxy at 0x7ff2d0de3460 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0d75050>>, 'templates_dict': None}
[2021-12-09 05:05:06,576] {logging_mixin.py:109} INFO - received tickers: ['MSFT', 'GE']
[2021-12-09 05:05:06,587] {base.py:79} INFO - Using connection to: id: demodb. Host: postgres, Port: 5432, Schema: demodb, Login: ***, Password: ***, extra: {}
[2021-12-09 05:05:06,595] {logging_mixin.py:109} INFO - MSFT length=21   ['MSFT', '2021-11-10', '333.9590271863857', '334.01891517951987', '329.3175249474008', '330.1958923339844']
[2021-12-09 05:05:06,606] {logging_mixin.py:109} INFO - GE length=21   ['GE', '2021-11-10', '112.5', '112.68000030517578', '108.11000061035156', '108.95999908447266']
[2021-12-09 05:05:06,613] {logging_mixin.py:109} INFO - 21 record inserted.
[2021-12-09 05:05:06,614] {python.py:152} INFO - Done. Returned value was: None
[2021-12-09 05:05:06,636] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=Download_Stock_Price, task_id=save_to_database, execution_date=20211208T050500, start_date=20211209T050506, end_date=20211209T050506
[2021-12-09 05:05:06,678] {local_task_job.py:154} INFO - Task exited with return code 0
[2021-12-09 05:05:06,709] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
