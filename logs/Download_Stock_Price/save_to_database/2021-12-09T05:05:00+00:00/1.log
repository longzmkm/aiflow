[2021-12-10 05:05:05,148] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-09T05:05:00+00:00 [queued]>
[2021-12-10 05:05:05,159] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-09T05:05:00+00:00 [queued]>
[2021-12-10 05:05:05,160] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2021-12-10 05:05:05,160] {taskinstance.py:1242} INFO - Starting attempt 1 of 2
[2021-12-10 05:05:05,160] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2021-12-10 05:05:05,178] {taskinstance.py:1262} INFO - Executing <Task(PythonOperator): save_to_database> on 2021-12-09 05:05:00+00:00
[2021-12-10 05:05:05,184] {standard_task_runner.py:52} INFO - Started process 68420 to run task
[2021-12-10 05:05:05,188] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'Download_Stock_Price', 'save_to_database', 'scheduled__2021-12-09T05:05:00+00:00', '--job-id', '57', '--raw', '--subdir', 'DAGS_FOLDER/download_stick_price.py', '--cfg-path', '/tmp/tmperqb0d56', '--error-file', '/tmp/tmpg4ipztfd']
[2021-12-10 05:05:05,190] {standard_task_runner.py:77} INFO - Job 57: Subtask save_to_database
[2021-12-10 05:05:05,212] {logging_mixin.py:109} INFO - Running <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-09T05:05:00+00:00 [running]> on host 48b97d3f8617
[2021-12-10 05:05:05,271] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=tlzmkm@gmail.com
AIRFLOW_CTX_DAG_OWNER=tl
AIRFLOW_CTX_DAG_ID=Download_Stock_Price
AIRFLOW_CTX_TASK_ID=save_to_database
AIRFLOW_CTX_EXECUTION_DATE=2021-12-09T05:05:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-09T05:05:00+00:00
[2021-12-10 05:05:05,273] {logging_mixin.py:109} INFO - ['__class__', '__contains__', '__delattr__', '__delitem__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'clear', 'copy', 'fromkeys', 'get', 'items', 'keys', 'pop', 'popitem', 'setdefault', 'update', 'values']
[2021-12-10 05:05:05,275] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7ff2eca67310>, 'dag': <DAG: Download_Stock_Price>, 'dag_run': <DagRun Download_Stock_Price @ 2021-12-09 05:05:00+00:00: scheduled__2021-12-09T05:05:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2021, 12, 10, 5, 5, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2021, 12, 9, 5, 5, 0, tzinfo=Timezone('UTC')), 'ds': '2021-12-09', 'ds_nodash': '20211209', 'execution_date': <Proxy at 0x7ff2d0de3c30 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1ef0>>, 'inlets': [], 'logical_date': DateTime(2021, 12, 9, 5, 5, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': <Proxy at 0x7ff2d0de32d0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de17a0>>, 'next_ds_nodash': <Proxy at 0x7ff2d0de3a00 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1cb0>>, 'next_execution_date': <Proxy at 0x7ff2d0de3960 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1f80>>, 'outlets': [], 'params': {}, 'prev_data_interval_start_success': <Proxy at 0x7ff2d0de3f00 with factory <function TaskInstance.get_template_context.<locals>.get_prev_data_interval_start_success at 0x7ff2d0dcbb90>>, 'prev_data_interval_end_success': <Proxy at 0x7ff2d0de3820 with factory <function TaskInstance.get_template_context.<locals>.get_prev_data_interval_end_success at 0x7ff2d0dcb950>>, 'prev_ds': <Proxy at 0x7ff2d0de3050 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1290>>, 'prev_ds_nodash': <Proxy at 0x7ff2d0dda640 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1200>>, 'prev_execution_date': <Proxy at 0x7ff2d0dda410 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1c20>>, 'prev_execution_date_success': <Proxy at 0x7ff2d0dda460 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1710>>, 'prev_start_date_success': <Proxy at 0x7ff2d0ddaf50 with factory <function TaskInstance.get_template_context.<locals>.get_prev_start_date_success at 0x7ff2d0d71320>>, 'run_id': 'scheduled__2021-12-09T05:05:00+00:00', 'task': <Task(PythonOperator): save_to_database>, 'task_instance': <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-09T05:05:00+00:00 [running]>, 'task_instance_key_str': 'Download_Stock_Price__save_to_database__20211209', 'test_mode': False, 'ti': <TaskInstance: Download_Stock_Price.save_to_database scheduled__2021-12-09T05:05:00+00:00 [running]>, 'tomorrow_ds': <Proxy at 0x7ff2d0dda730 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1e60>>, 'tomorrow_ds_nodash': <Proxy at 0x7ff2d0dda6e0 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0de1d40>>, 'ts': '2021-12-09T05:05:00+00:00', 'ts_nodash': '20211209T050500', 'ts_nodash_with_tz': '20211209T050500+0000', 'var': {'json': None, 'value': None}, 'conn': <***.models.taskinstance.TaskInstance.get_template_context.<locals>.ConnectionAccessor object at 0x7ff2ec996810>, 'yesterday_ds': <Proxy at 0x7ff2d0de9280 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0d75050>>, 'yesterday_ds_nodash': <Proxy at 0x7ff2d0de9870 with factory <function TaskInstance.get_template_context.<locals>.deprecated_proxy.<locals>.deprecated_func at 0x7ff2d0d750e0>>, 'templates_dict': None}
[2021-12-10 05:05:05,285] {logging_mixin.py:109} INFO - received tickers: ['MSFT', 'GE']
[2021-12-10 05:05:05,297] {base.py:79} INFO - Using connection to: id: demodb. Host: postgres, Port: 5432, Schema: demodb, Login: ***, Password: ***, extra: {}
[2021-12-10 05:05:05,306] {logging_mixin.py:109} INFO - MSFT length=21   ['MSFT', '2021-11-11', '330.6450687299609', '333.1604557205248', '329.90642987138153', '331.8229064941406']
[2021-12-10 05:05:05,318] {logging_mixin.py:109} INFO - GE length=21   ['GE', '2021-11-11', '108.55000305175781', '109.5999984741211', '106.77999877929688', '107.0']
[2021-12-10 05:05:05,325] {logging_mixin.py:109} INFO - 21 record inserted.
[2021-12-10 05:05:05,325] {python.py:152} INFO - Done. Returned value was: None
[2021-12-10 05:05:05,338] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=Download_Stock_Price, task_id=save_to_database, execution_date=20211209T050500, start_date=20211210T050505, end_date=20211210T050505
[2021-12-10 05:05:05,369] {local_task_job.py:154} INFO - Task exited with return code 0
[2021-12-10 05:05:05,402] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
